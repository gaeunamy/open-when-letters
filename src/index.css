/* 1. [전역 설정] 모든 요소의 시스템 간섭 및 텍스트 조정 차단 */
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;

  /* 텍스트 선택 및 파란 커서 방지 */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;

  /* 꾹 눌렀을 때 시스템 메뉴(공유, 복사, 찾아보기) 및 햅틱 차단 */
  -webkit-touch-callout: none;

  /* 기기 방향 전환 시 텍스트 크기 자동 조절 방지 */
  -webkit-text-size-adjust: 100% !important;
  -moz-text-size-adjust: 100% !important;
  -ms-text-size-adjust: 100% !important;
  text-size-adjust: 100% !important;
}

/* 2. [문서 설정] 배경, 폰트 및 터치 하이라이트 제거 */
html, body {
  width: 100%;
  height: 100%;
  font-size: 16px !important; /* 모바일 가독성 고정 */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  background: #05070d;
  overflow: hidden; /* 전체 스크롤 방지 */

  /* 터치 시 순간적으로 발생하는 파란색 하이라이트 제거 */
  -webkit-tap-highlight-color: transparent;
  
  /* 폰트 렌더링 최적화 */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  
  /* 삼성 인터넷 글꼴 크기 강제 고정 */
  text-size-adjust: 100% !important;
  -webkit-text-size-adjust: 100% !important;
  -moz-text-size-adjust: 100% !important;
  -ms-text-size-adjust: 100% !important;
}

/* 안드로이드 기기 전용 폰트 크기 조정 */
html.android {
  font-size: 15px !important;
}

html.android body {
  -webkit-text-zoom: none;
}

/* iOS 기기는 기본값 유지 */
html.ios {
  font-size: 16px !important;
}

/* 3. [입력 요소] 폰트 상속 및 예외 처리 (별 편지 작성용) */
input, textarea, button, select {
  font-family: inherit;
  font-size: inherit !important;
}

/* 글자를 입력해야 하는 곳은 시스템 기능을 다시 열어줍니다 */
textarea, input {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
  -webkit-touch-callout: default;
}

/* 4. [상호작용 최적화] 터치 반응 및 조작 설정 */
button, .star-wrapper, .scratch-card, .nav-btn, .moon-button {
  touch-action: manipulation; /* 더블탭 줌 방지 및 터치 반응 속도 향상 */
  cursor: pointer;
}

/* ===== [신규] 공통 모달 오버레이 (App.jsx 중복 제거용) ===== */
.full-screen-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  
  /* 기본 배경색 (0.95 투명도) */
  background: rgba(5, 7, 13, 0.95);
  
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 100;
}

/* ===== App Main Styles ===== */
#root {
  width: 100%;
  height: 100%;
}

/* ===== Night Sky Background ===== */
.sky {
  position: relative;
  width: 100%;
  height: 100%;
  background: radial-gradient(circle at bottom, #0b1d3a 0%, #05070d 60%);
  overflow: hidden;
}

/* ===== Stars Layer + 초기 하늘 모션 ===== */
.stars-layer {
  position: absolute;
  inset: 0;
  animation: starsDescend 4s ease-out forwards;
}

@keyframes starsDescend {
  from {
    transform: translateY(-25%);
    opacity: 0;
  }
  to {
    transform: translateY(0%);
    opacity: 1;
  }
}

/* ===== Stars ===== */

/* 별과 라벨을 감싸는 컨테이너 (클릭 영역 그 자체) */
.star-wrapper {
  position: absolute;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column-reverse; /* 별이 아래, 라벨이 위 */
  align-items: center;
  justify-content: center;
  padding: 40px; /* 터치 범위 확보 */
  pointer-events: none;
  z-index: 1;

  /* [테스트용] 클릭 범위 확인
  background-color: rgba(255, 0, 0, 0.3);
  border: 1px solid yellow; */
}

/* 클릭 가능한 컨테이너 */
.star-wrapper.clickable {
  pointer-events: auto; 
  cursor: pointer;
  z-index: 100 !important; 
}

.star-wrapper.clickable:hover .star {
  transform: scale(1.3);
}

/* 별 스타일 */
.star {
  position: relative;
  border-radius: 50%;
  transition: all 0.3s ease;
}

/* 배경 별 */
.star-background {
  background: white;
  width: 1.5px !important;
  height: 1.5px !important;
  opacity: 0.6;
  transition: all 0.5s ease-in-out;
}

/* 메시지 별 기본 */
.star-message {
  background: #ffe87f;
  width: 2px !important;
  height: 2px !important;
  box-shadow:
    0 0 8px rgba(255, 232, 127, 0.6),
    0 0 16px rgba(255, 232, 127, 0.4),
    0 0 24px rgba(255, 232, 127, 0.2);
  opacity: 0.6;
  transition: transform 2.5s ease-in-out, opacity 2.5s ease-in-out;
  animation: messageSparkle 6s ease-out;
}

/* 별 반짝이기 */
.star-active {
  transform: scale(2.5);
  opacity: 1;
}

/* 메시지 라벨 */
.star-message-label {
  position: relative;
  color: #ffe87f;
  font-size: 0.9rem;
  opacity: 0;
  transform: translateY(-5px) scale(0.8);
  margin-bottom: 5px;
  transition: opacity 2.5s ease-in-out, transform 2.5s ease-in-out;
  white-space: nowrap;
  text-shadow: 0 0 4px rgba(255, 232, 127, 0.8);

  /* [테스트용] 텍스트 숨김
  display: none !important; */
}

.star-message-label.active {
  opacity: 1;
  transform: translateY(-10px) scale(1);
}

/* 인트로 안내 문구 스타일 */
.intro-text {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: rgba(255, 255, 255, 0.8);
  font-size: 1.1rem;
  text-align: center;
  pointer-events: none;
  opacity: 0;
  animation: introFade 6s ease-in-out forwards;
  z-index: 5;
  text-shadow: 0 0 10px rgba(255, 232, 127, 0.3);
  width: 100%;
  padding: 0 20px;
  line-height: 1.8;
}

@keyframes introFade {
  0% { opacity: 0; transform: translate(-50%, -40%); }
  20% { opacity: 1; transform: translate(-50%, -50%); }
  70% { opacity: 1; }
  100% { opacity: 0; transform: translate(-50%, -60%); }
}

/* 별빛 번짐 효과 */
.starlight-overlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at var(--click-x) var(--click-y), rgba(255,232,127,0.3) 0%, rgba(255,200,100,0.2) 20%, rgba(11,29,58,0.95) 60%, #05070d 100%);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.8s ease-out;
  z-index: 10;
}
.starlight-overlay.active { opacity: 1; }

/* 메시지 모달 */
.message-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.8);
  opacity: 0;
  max-width: 500px;
  width: 90%;
  padding: 40px;
  background: rgba(11, 29, 58, 0.9);
  border: 2px solid rgba(255, 232, 127, 0.3);
  border-radius: 20px;
  box-shadow: 0 0 40px rgba(255, 232, 127, 0.4);
  transition: all 0.8s ease-out;
  z-index: 20;
  pointer-events: none;
}
.message-modal.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
.message-title { color: #ffe87f; font-size: 1.3rem; font-weight: 600; margin-bottom: 20px; text-align: center; }
.message-content { color: #e8f4ff; font-size: 1rem; line-height: 1.6; text-align: center; }

/* 달 버튼 */
.moon-button {
  position: fixed;
  top: 30px;
  right: 30px;
  width: 60px;
  height: 60px;
  background: radial-gradient(circle at 35% 35%, #fff9e6 0%, #f0e68c 50%, #daa520 100%);
  border-radius: 50%;
  border: none;
  box-shadow: 0 0 20px rgba(255, 249, 230, 0.5), 0 0 40px rgba(255, 249, 230, 0.3), inset -5px -5px 15px rgba(0, 0, 0, 0.2);
  cursor: pointer;
  opacity: 0;
  transform: scale(0.8);
  transition: all 0.5s ease-out;
  z-index: 150;
  pointer-events: none;
}
.moon-button.active { opacity: 1; transform: scale(1); pointer-events: auto; }
.moon-button:hover { transform: scale(1.1); box-shadow: 0 0 30px rgba(255, 249, 230, 0.7), 0 0 50px rgba(255, 249, 230, 0.4), inset -5px -5px 15px rgba(0, 0, 0, 0.2); }

/* SVG 컨테이너 */
.constellation-svg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

/* 별자리 Path 스타일 */
.constellation-path {
  stroke: rgba(255, 232, 127, 0.4);
  stroke-width: 1.5px;
  stroke-linecap: round;
  stroke-linejoin: round;
  fill: none;
  vector-effect: non-scaling-stroke; 
  stroke-dasharray: 40;
  stroke-dashoffset: 40;
  animation: drawPath 40s ease-in-out forwards;
  filter: drop-shadow(0 0 2px rgba(255, 232, 127, 0.8));
}

@keyframes drawPath {
  to { stroke-dashoffset: 0; }
}

/* 하단 일일 메시지 컨테이너 */
.daily-message-container {
  position: fixed;
  top: 70%; 
  left: 50%;
  transform: translate(-50%, 0);
  width: 90%;
  max-width: 600px;
  text-align: center;
  color: rgba(255, 255, 255, 0.9);
  font-size: 1.2rem;
  line-height: 1.6;
  text-shadow: 0 0 10px rgba(255, 232, 127, 0.4);
  word-break: keep-all;
  opacity: 0;
  transition: opacity 3s ease-in-out; 
  pointer-events: none;
  z-index: 10;
}
.daily-message-container.active { opacity: 1; }

/* 히든 질문 모달 */
.hidden-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.8);
  opacity: 0;
  background: rgba(11, 29, 58, 1);
  border: 2px solid #ffe87f;
  border-radius: 20px;
  padding: 40px 20px;
  text-align: center;
  z-index: 200;
  transition: all 0.5s ease;
  pointer-events: none;
}
.hidden-modal.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
.hidden-text { color: #ffe87f; font-size: 1.0rem; margin-bottom: 30px; word-break: keep-all; overflow-wrap: break-word; }
.hidden-buttons { display: flex; justify-content: center; gap: 20px; width: 100%; margin-top: 20px; }
.hidden-buttons button {
  background: transparent;
  border: 1px solid #ffe87f;
  color: #ffe87f;
  padding: 10px 40px;
  border-radius: 30px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s;
}
.hidden-buttons button:hover { background: #ffe87f; color: #0b1d3a; font-weight: bold; transform: scale(1.1); }

/* 히든 사진 모달 (배경) */
.photo-modal {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  z-index: 60;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
  background: rgba(5, 7, 13, 0.8);
  backdrop-filter: blur(5px);
}

.photo-content {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 15px;
  width: 100%;
}

.photo-modal img {
  max-width: 85vw;
  max-height: 55vh;
  border-radius: 15px;
  box-shadow: 0 0 30px rgba(255, 232, 127, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.8);
  cursor: pointer;
  object-fit: contain;
}

.photo-controls { display: flex; align-items: center; justify-content: center; gap: 30px; width: 100%; }
.nav-btn {
  background: rgba(255, 255, 255, 0.15);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
  width: 50px; height: 50px;
  border-radius: 50%;
  font-size: 1.5rem;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  padding-bottom: 4px;
  transition: all 0.2s;
}
.nav-btn:hover { background: rgba(255, 232, 127, 0.8); color: #0b1d3a; border-color: #ffe87f; transform: scale(1.1); }
.page-counter { color: rgba(255, 255, 255, 0.8); font-size: 1.1rem; font-weight: 300; letter-spacing: 2px; }
.photo-caption { margin-top: 5px; color: white; font-size: 1rem; text-align: center; text-shadow: 0 0 5px black; line-height: 1.5; }

.footer-copyright {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  color: rgba(255, 255, 255, 0.3);
  font-size: 0.7rem;
  font-weight: 300;
  letter-spacing: 1px;
  pointer-events: none;
  z-index: 10;
  white-space: nowrap;
}

/* "여전히 심심하다면?" 트리거 버튼 */
.bored-trigger-btn {
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.5);
  color: #ddd;
  padding: 8px 15px;
  border-radius: 20px;
  font-size: 0.9rem;
  cursor: pointer;
  margin-top: 15px;
  transition: all 0.3s;
}

@media (hover: hover) {
  .bored-trigger-btn:hover { 
    background: rgba(255, 232, 127, 0.2); 
    border-color: #ffe87f; 
    color: #ffe87f; 
  }
}

/* 심심 메뉴 모달 */
.bored-menu-modal {
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  opacity: 0;
  background: rgba(11, 29, 58, 0.95);
  border: 2px solid #ffe87f;
  border-radius: 20px;
  padding: 40px;
  z-index: 50;
  transition: all 0.5s ease;
  pointer-events: none;
  width: 80%;
  max-width: 400px;
}
.bored-menu-modal.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
.bored-menu-list { display: flex; flex-direction: column; gap: 15px; align-items: center; }
.bored-menu-list button {
  background: transparent;
  border: 1px solid #ffe87f;
  color: #ffe87f;
  padding: 15px 20px;
  border-radius: 15px;
  font-size: 1rem;
  line-height: 1.4;
  cursor: pointer;
  width: 100%;
  transition: all 0.3s;
  word-break: keep-all;
}
.bored-menu-list button:hover { background: #ffe87f; color: #0b1d3a; font-weight: bold; transform: scale(1.05); }

/* 오디오 감싸는 박스 */
.audio-wrapper { margin-top: 25px; display: flex; flex-direction: column; align-items: center; gap: 10px; width: 100%;}
.audio-label { color: #ffe87f; font-size: 0.9rem; letter-spacing: 1px; opacity: 0.8; margin-bottom: 5px; }
.custom-audio { width: 100%; max-width: 280px; height: 40px; outline: none; filter: invert(1); opacity: 0.8; transition: opacity 0.3s; cursor: pointer; }
.custom-audio::-webkit-media-controls-enclosure { background-color: transparent !important; box-shadow: none !important; }
.custom-audio:hover { opacity: 1; }

/* 오디오 효과 컨테이너 */
.audio-effects {
  position: absolute;
  top: 75%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  max-width: 500px;
  height: 300px;
  pointer-events: none;
  z-index: -1;
}

.star-particle {
  position: absolute;
  bottom: 25%;
  width: 3px;
  height: 3px;
  background: #ffe87f;
  border-radius: 50%;
  box-shadow: 0 0 6px rgba(255, 232, 127, 0.8);
  animation: floatUp 4s ease-in-out infinite;
  opacity: 0;
}

@keyframes floatUp {
  0% {
    transform: translateY(0) scale(1);
    opacity: 0;
  }
  5% {
    opacity: 1;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateY(-200px) scale(0.5);
    opacity: 0;
  }
}

/* 칭찬 섹션 */
.praise-section { width: 100%; margin-top: 20px; display: flex; flex-direction: column; align-items: center; }
.praise-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; }
.praise-grid button {
  background: transparent;
  border: 1px solid rgba(255, 232, 127, 0.5);
  color: #ffe87f;
  padding: 10px 5px;
  border-radius: 15px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}
.praise-grid button:hover { background: rgba(255, 232, 127, 0.2); border-color: #ffe87f; color: #fff; transform: scale(1.05); }
.praise-grid button.playing {
  background: #ffe87f; color: #0b1d3a; border-color: #ffe87f; font-weight: bold;
  box-shadow: 0 0 15px rgba(255, 232, 127, 0.6); transform: scale(1.05);
  animation: pulseButton 1.5s infinite;
}
@keyframes pulseButton {
  0% { box-shadow: 0 0 15px rgba(255, 232, 127, 0.6); }
  50% { box-shadow: 0 0 25px rgba(255, 232, 127, 0.9); }
  100% { box-shadow: 0 0 15px rgba(255, 232, 127, 0.6); }
}

/* TMI 모달 */
.tmi-modal { width: 90%; max-width: 450px; max-height: 80vh; display: flex; flex-direction: column; }
.tmi-title { font-family: 'Georgia', serif; font-style: italic; font-size: 1.5rem; margin-bottom: 20px; }
.tmi-scroll-container { flex: 1; overflow-y: auto; padding-right: 10px; text-align: left; margin-bottom: 20px; }
.tmi-scroll-container::-webkit-scrollbar { width: 5px; }
.tmi-scroll-container::-webkit-scrollbar-thumb { background: rgba(255, 232, 127, 0.5); border-radius: 10px; }
.tmi-item { color: #e8f4ff; font-size: 0.95rem; line-height: 1.7; margin-bottom: 25px; white-space: pre-wrap; border-bottom: 1px solid rgba(255, 232, 127, 0.1); padding-bottom: 15px; }
.tmi-item:last-child { border-bottom: none; color: #ffe87f; font-weight: bold; }

/* 밸런스 게임 모달 */
.balance-modal { width: 95%; max-width: 500px; max-height: 85vh; display: flex; flex-direction: column; }
.balance-title { font-family: 'Georgia', serif; font-size: 1.5rem; letter-spacing: 2px; color: #ffe87f; }
.balance-scroll-container { flex: 1; overflow-y: auto; padding: 10px; }
.balance-item { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px dashed rgba(255, 232, 127, 0.2); }
.balance-option { width: 100%; padding: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 232, 127, 0.3); border-radius: 12px; color: #e8f4ff; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease; word-break: keep-all; }
.balance-option.selected { background: rgba(255, 232, 127, 0.2); border-color: #ffe87f; color: #ffe87f; font-weight: bold; box-shadow: 0 0 15px rgba(255, 232, 127, 0.4), inset 0 0 10px rgba(255, 232, 127, 0.2); transform: scale(1.02); }
.balance-vs { font-style: italic; font-weight: bold; color: rgba(255, 232, 127, 0.6); font-size: 0.8rem; }
.balance-scroll-container::-webkit-scrollbar { width: 5px; }
.balance-scroll-container::-webkit-scrollbar-thumb { background: rgba(255, 232, 127, 0.5); border-radius: 10px; }

/* 숨 고르기 애니메이션 */
.breathing-circle {
  width: 120px; height: 120px; border-radius: 50%;
  background: radial-gradient(circle, rgba(255, 232, 127, 0.3), rgba(255, 232, 127, 0.1));
  border: 2px solid rgba(255, 232, 127, 0.6);
  box-shadow: 0 0 40px rgba(255, 232, 127, 0.4);
  user-select: none;
}
.breathing-circle.inhale { animation: breatheIn 4s ease-in-out forwards; }
.breathing-circle.exhale { animation: breatheOut 4s ease-in-out forwards; }
@keyframes breatheIn { 0% { transform: scale(1); opacity: 0.6; } 100% { transform: scale(2.5); opacity: 0.9; } }
@keyframes breatheOut { 0% { transform: scale(2.5); opacity: 0.9; } 100% { transform: scale(1); opacity: 0.6; } }

.breathing-text {
  margin-top: 200px; color: rgba(255, 232, 127, 0.7); font-size: 1.2rem;
  font-weight: 300; letter-spacing: 2px; text-align: center;
  text-shadow: 0 0 8px rgba(255, 232, 127, 0.3);
  animation: gentleFade 20s ease-in-out infinite;
}
@keyframes gentleFade {
  0% { opacity: 0; } 5% { opacity: 1; } 25% { opacity: 1; } 30% { opacity: 0; } 100% { opacity: 0; }
}

/* 노래방 모달 */
.karaoke-modal { width: 90%; max-width: 400px; }
.karaoke-title { font-size: 1.5rem; margin-bottom: 25px; }
.karaoke-content { display: flex; flex-direction: column; align-items: center; gap: 15px; width: 100%; }
.karaoke-subtitle { color: rgba(255, 232, 127, 0.8); font-size: 0.95rem; text-align: center; margin-top: 10px; }

/* 하트 관련 */
.heart-container {
  position: relative; width: 100px; height: 100px;
  display: flex; align-items: center; justify-content: center;
  transition: transform 0.1s linear, opacity 0.5s ease-out;
  user-select: none; -webkit-tap-highlight-color: transparent;
  filter: drop-shadow(0 0 10px rgba(255, 94, 120, 0.5)) drop-shadow(0 0 25px rgba(255, 143, 163, 0.3));
  --light-x: 50%; --light-y: 60%;
}
.css-heart {
  position: relative; width: 60px; height: 60px;
  background: #ff7a90; transform: rotate(-45deg);
  box-shadow: none;
}
.css-heart::before, .css-heart::after {
  content: ''; position: absolute; width: 60px; height: 60px;
  background: inherit; border-radius: 50%; box-shadow: none;
}
.css-heart::before { top: -30px; left: 0; }
.css-heart::after { left: 30px; top: 0; }
.heart-container::after {
  content: ''; position: absolute; inset: 15%;
  background: radial-gradient(circle at var(--light-x) var(--light-y), rgba(180, 20, 60, 0.35) 0%, rgba(255, 80, 120, 0.25) 35%, rgba(255, 255, 255, 0.45) 65%, rgba(255, 255, 255, 0.65) 80%, transparent 100%);
  filter: blur(10px); border-radius: 50%; pointer-events: none;
}

@keyframes heartbeat {
  0% { transform: rotate(-45deg) scale(1); }
  15% { transform: rotate(-45deg) scale(1.15); }
  30% { transform: rotate(-45deg) scale(1); }
  45% { transform: rotate(-45deg) scale(1.08); }
  60% { transform: rotate(-45deg) scale(1); }
  100% { transform: rotate(-45deg) scale(1); }
}
.css-heart.beating { animation: heartbeat 1s infinite cubic-bezier(0.215, 0.61, 0.355, 1); }

.color-burst-container {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%); width: 100px; height: 100px;
  pointer-events: none; z-index: 0;
}
.color-burst-effect {
  width: 100%; height: 100%; border-radius: 50%;
  background: radial-gradient(circle, rgba(255, 232, 127, 0.9) 0%,rgba(255, 232, 127, 0.4) 50%,transparent 100%);
  opacity: 0; transform: scale(0);
}
.color-burst-effect.active { animation: burstOut 0.8s ease-out forwards; }
@keyframes burstOut { 0% { opacity: 0.8; transform: scale(0.5); } 100% { opacity: 0; transform: scale(20); } }

.finish-container { opacity: 0; transform: translateY(20px); animation: finishFadeIn 0.8s ease-out forwards; }
@keyframes finishFadeIn { to { opacity: 1; transform: translateY(0); } }
.finish-heart { margin: 0 auto 40px; transform: scale(1.2); filter: drop-shadow(0 0 15px rgba(255, 94, 120, 0.8)); }
.praise-finish-text { font-size: 1.2rem; color: #ffe87f; font-weight: 500; text-shadow: 0 0 15px rgba(255, 232, 127, 0.6); white-space: nowrap; }

/* 진단 스타일 */
.flashing-text { animation: flash 0.8s infinite alternate; color: #ffe87f; font-weight: bold; }
@keyframes flash { from { opacity: 1; } to { opacity: 0.3; } }
.processing-pulse { animation: fastPulse 1.2s infinite; }
@keyframes fastPulse { 0% { transform: scale(1.2); filter: blur(5px); } 50% { transform: scale(1.3); filter: blur(10px); } 100% { transform: scale(1.2); filter: blur(5px); } }

.diagnosis-btn { border-color: #ff7a90 !important; color: #ff7a90 !important; }
.diagnosis-btn:hover { background: rgba(255, 122, 144, 0.2) !important; border-color: #ff7a90 !important; color: #ff7a90 !important; }

.mic-button {
  width: 80px; height: 80px; border-radius: 50%;
  background: rgba(255, 232, 127, 0.2); border: 2px solid #ffe87f; color: #ffe87f;
  font-size: 1.5rem; cursor: pointer; transition: all 0.3s; margin-top: 50px;
  user-select: none;
}
.mic-button.active { background: #ffe87f; color: #0b1d3a; transform: scale(1.2); box-shadow: 0 0 20px #ffe87f; }
.mic-button:disabled { opacity: 0.3; cursor: not-allowed; }

/* 별 편지지 모달 */
.star-letter-modal {
  position: fixed; inset: 0; background: transparent;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 30px; z-index: 100; transition: all 1.5s ease-in-out;
}
.star-letter-modal.hidden .star-paper, .star-letter-modal.hidden .star-letter-buttons { display: none; }
.star-letter-modal.flying { background: transparent; }
.star-letter-modal.flying .star-paper {
  animation: explodeToLight 4s ease-out forwards;
  background: radial-gradient(circle, #ffe87f 0%, #ffc864 60%, transparent 100%);
  border-radius: 50%;
}
@keyframes explodeToLight { 0% { opacity: 0.8; transform: scale(1); } 100% { opacity: 0; transform: scale(20); } }

@keyframes newStarSparkle {
  0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
  40% { transform: translate(-50%, -50%) scale(1); opacity: 0.4; }
  55% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; filter: drop-shadow(0 0 8px #ffe87f); }
  70% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }
  85% { transform: translate(-50%, -50%) scale(1.3); opacity: 0.9; filter: drop-shadow(0 0 5px #ffe87f); }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; filter: none; }
}
.star-letter-modal.hidden { display: none; }

.user-star {
  position: absolute; width: 1.8px !important; height: 1.8px !important;
  background-color: #ffe87f; border-radius: 50%; opacity: 0.6;
  cursor: help; animation: newStarSparkle 6s ease-out;
  transform: translate(-50%, -50%);
}

.star-paper {
  width: 320px; height: 320px; background: #ffe87f;
  clip-path: polygon(50% 2%, 64% 33%, 98% 35%, 73% 58%, 82% 92%, 50% 75%, 18% 92%, 27% 58%, 2% 35%, 36% 33%);
  display: flex; align-items: center; justify-content: center;
  padding-top: 45px; filter: drop-shadow(0 0 15px rgba(255, 232, 127, 0.7));
}
.textarea-wrapper { position: relative; width: 150px; max-height: 140px; display: flex; justify-content: center; }
.custom-placeholder {
  position: absolute; top: -30px; font-size: 0.8rem;
  color: rgba(90, 77, 29, 0.5); text-align: center; line-height: 1.5; pointer-events: none; z-index: 1;
}
.star-paper textarea {
  width: 140%; height: auto; max-height: 140px;
  background: transparent; border: none; outline: none; resize: none;
  text-align: center; font-family: inherit; font-size: 0.8rem; color: #5a4d1d;
  padding-top: 0; margin-top: -15px; line-height: 1.6; position: relative; z-index: 2; overflow: hidden;
}
.textarea-wrapper:focus-within .custom-placeholder { display: none; }
.star-paper textarea::placeholder { font-size: 0.8rem; color: rgba(90, 77, 29, 0.5); transition: color 0.3s; white-space: pre-line; }
.star-paper textarea:focus::placeholder { color: transparent; }

.star-letter-buttons { display: flex; gap: 15px; animation: fadeIn 0.5s ease-out; }
.send-star-btn { border-color: #ffe87f !important; color: #ffe87f !important; font-weight: bold !important; box-shadow: 0 0 10px rgba(255, 232, 127, 0.3); }
.star-letter-buttons .bored-trigger-btn:hover { background: rgba(255, 232, 127, 0.2) !important; transform: scale(1.05); }

@keyframes messageSparkle {
  0% { transform: scale(0); opacity: 0; }
  40% { transform: scale(1); opacity: 0.4; }
  55% { transform: scale(1.5); opacity: 1; filter: drop-shadow(0 0 15px #ffe87f); }
  70% { transform: scale(1); opacity: 0.5; }
  85% { transform: scale(1.5); opacity: 0.9; filter: drop-shadow(0 0 10px #ffe87f); }
  100% { transform: scale(1); opacity: 0.6; background-color: #ffe87f; box-shadow: 0 0 8px rgba(255, 232, 127, 0.6), 0 0 16px rgba(255, 232, 127, 0.4); }
}

/* 터치 최적화 강제 적용 */
button, .nav-btn, .moon-button, .diagnosis-btn, .bored-trigger-btn { touch-action: manipulation !important; }
@media (hover: none) {

  /* 1. 터치 시(Hover) PC용 효과 무력화 (기본 상태 유지) */
  button:hover, 
  .nav-btn:hover, 
  .moon-button:hover, 
  .diagnosis-btn:hover,
  .bored-trigger-btn:hover,
  .bored-menu-list button:hover,
  .praise-grid button:hover,
  .hidden-buttons button:hover { 
    transform: none !important; 
    background: transparent !important; 
    box-shadow: none !important;
  }

  /* 2. 버튼별 호버 시 색상 강제 고정 (흰색 변함 방지) */
  
  /* 칭찬 버튼: 터치해도 글자는 노랑, 테두리는 연한 노랑 유지 */
  .praise-grid button:hover {
    color: #ffe87f !important; 
    border-color: rgba(255, 232, 127, 0.5) !important;
  }

  /* 심심 메뉴 & 기타 버튼: 터치해도 글자/테두리 노랑 유지 */
  .bored-menu-list button:hover,
  .hidden-buttons button:hover {
    color: #ffe87f !important;
    border-color: #ffe87f !important;
    font-weight: normal !important;
  }

  .nav-btn:hover {
    background: rgba(255, 255, 255, 0.15) !important;
    color: white !important; 
    border-color: rgba(255, 255, 255, 0.3) !important;
    transform: none !important;
  }

  .bored-trigger-btn:hover, 
  .bored-trigger-btn:focus,
  .bored-trigger-btn:focus-visible {
    color: #ddd !important;
    border-color: rgba(255, 255, 255, 0.5) !important;
    background: transparent !important;
  }

  .bored-menu-list button:focus,
  .bored-menu-list button:active {
  font-weight: normal !important;
  outline: none;
  }

  /* 3. 꾹 눌렀을 때(Active) 확실한 반응 (노란 배경 + 남색 글씨) */
  button:active, 
  .nav-btn:active, 
  .moon-button:active, 
  .diagnosis-btn:active,
  .bored-trigger-btn:active,
  .bored-menu-list button:active,
  .praise-grid button:active,
  .hidden-buttons button:active {
    background: #ffe87f !important;    /* 배경 꽉 채우기 */
    color: #0b1d3a !important;         /* 글자 진한 남색 */
    border-color: #ffe87f !important;  /* 테두리도 노란색 */
    font-weight: bold !important;      
    transform: scale(0.96) !important; /* 살짝 작아지는 느낌 */
    opacity: 1 !important;
  }
}

/* 가이드 버튼 */
.guide-button {
  position: fixed; bottom: 18px; left: 15px; width: 40px; height: 40px;
  background: transparent; border: none; z-index: 100;
  color: rgba(255, 232, 127, 0.6); font-size: 1.2rem; font-weight: normal;
  border-radius: 50%; cursor: pointer; z-index: 150; transition: all 0.5s ease-out;
  display: flex; align-items: center; justify-content: center; touch-action: manipulation; opacity: 0;
  animation: guideAppear 0.8s ease-out 6s forwards, guideTwinkle 3s infinite ease-in-out 6.8s;
}

@keyframes guideAppear { from { opacity: 0; transform: scale(0.8); } to { opacity: 0.5; transform: scale(1); } }
@keyframes guideTwinkle {
  0% { opacity: 0.5; text-shadow: 0 0 5px rgba(255, 232, 127, 0.2); transform: scale(1); }
  50% { opacity: 1; text-shadow: 0 0 15px rgba(255, 232, 127, 0.6), 0 0 25px rgba(255, 232, 127, 0.2); transform: scale(1.05); }
  100% { opacity: 0.5; text-shadow: 0 0 5px rgba(255, 232, 127, 0.2); transform: scale(1); }
}
.guide-button:hover { animation-play-state: paused; opacity: 1; color: rgba(255, 232, 127, 1); transform: scale(1.1); text-shadow: 0 0 12px rgba(255, 232, 127, 0.8), 0 0 25px rgba(255, 232, 127, 0.4); }
.guide-button.hidden { opacity: 0; pointer-events: none; animation: none; }

/* 가이드 모달 */
.guide-modal-content { text-align: left; max-width: 450px; width: 90%; max-height: 80vh; display: flex; flex-direction: column; }
.guide-title { text-align: center; font-size: 1.4rem; color: #ffe87f; margin-bottom: 25px; font-weight: bold; letter-spacing: 1px; }
.guide-body { flex: 1; overflow-y: auto; padding-right: 10px; }
.guide-body::-webkit-scrollbar { width: 4px; }
.guide-body::-webkit-scrollbar-thumb { background: rgba(255, 232, 127, 0.3); border-radius: 4px; }
.guide-step { display: flex; gap: 10px; margin-bottom: 12px; font-size: 1rem; color: #e8f4ff; line-height: 1.5; word-break: keep-all; }
.step-num { color: #ffe87f; font-weight: bold; min-width: 15px; }
.guide-divider { border: 0; height: 1px; background: rgba(255, 232, 127, 0.3); margin: 20px 0; }
.guide-extra { font-size: 0.95rem; color: #e8f4ff; }
.guide-extra p { margin-bottom: 5px; word-break: keep-all; }
.guide-extra b { color: #ffe87f; }
.guide-extra .sub-text { font-size: 0.85rem; color: rgba(255, 255, 255, 0.6); margin-bottom: 15px; padding-left: 10px; border-left: 2px solid rgba(255, 232, 127, 0.3); line-height: 1.4; }
.guide-button.paused { animation: none; opacity: 1; transform: scale(1); }

/* 양자리별 빛번짐 효과 (크기 변화 X, 빛만 일렁임) */
@keyframes starGlow {
  0%, 100% {
    /* 커진 상태 (등장 효과가 끝난 시점과 동일) */
    transform: scale(2.5);
    box-shadow: 
      0 0 15px rgba(255, 255, 255, 1),
      0 0 30px rgba(255, 232, 127, 1),
      0 0 60px rgba(255, 232, 127, 0.8),
      0 0 100px rgba(255, 232, 127, 0.5);
    opacity: 1;
  }
  50% {
    /* 작아질 때 (숨 고르기) */
    transform: scale(1.8);
    box-shadow: 
      0 0 10px rgba(255, 232, 127, 0.5),
      0 0 20px rgba(255, 232, 127, 0.3);
    opacity: 0.8;
  }
}

/* ===== 가은쌤 진단 인트로 스타일 ===== */
.intro-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 50;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  padding: 20px;
  
  /* 중앙은 어둡고(투명 검정), 가장자리는 노란빛이 감도는 비네팅 효과 */
  background: radial-gradient(circle at center, rgba(5, 7, 13, 0.8) 0%, rgba(255, 232, 127, 0.1) 50%, rgba(255, 232, 127, 0.4) 100%);
  backdrop-filter: blur(8px); /* 블러 효과 */
  
  /* [핵심] 처음에 안 보이게 설정 */
  opacity: 0;
  
  /* 투명도 변화 애니메이션 시간 (1초) */
  transition: opacity 1.5s ease-in-out;
  
  pointer-events: none; /* 페이드 아웃 시 클릭 방해 방지 */
}

/* 페이드 상태 클래스 */
.intro-overlay.fade-in { opacity: 1; pointer-events: auto; }
.intro-overlay.fade-out { opacity: 0; pointer-events: none; }

/* 인트로 텍스트 스타일 */
.intro-message {
  color: #fff;
  font-size: 1.4rem;
  line-height: 1.8;
  font-weight: 300;
  text-shadow: 0 0 10px rgba(255, 232, 127, 0.5);
  word-break: keep-all;
}
.intro-message b {
  color: #ffe87f;
  font-weight: 600;
  font-size: 1.6rem;
}

/* 오디오 재생 시 숨쉬기 애니메이션 */
@keyframes audioBreathing {
  0% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 40px rgba(255, 232, 127, 0.4); border-color: rgba(255, 232, 127, 0.3); }
  50% { transform: translate(-50%, -50%) scale(1.02); box-shadow: 0 0 70px rgba(255, 232, 127, 0.7); border-color: rgba(255, 232, 127, 0.8); }
  100% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 40px rgba(255, 232, 127, 0.4); border-color: rgba(255, 232, 127, 0.3); }
}

/* 재생 중일 때 모달에 적용될 클래스 */
.message-modal.audio-playing {
  animation: audioBreathing 4s ease-in-out infinite; /* 4초 주기로 천천히 숨쉬기 */
  background: rgba(11, 29, 58, 0.9); /* 배경을 조금 더 진하게 */
  z-index: 300; /* 가장 위로 */

  transition: opacity 2s ease, transform 2s ease, background-color 2s ease, box-shadow 2s ease;
}

/* 재생 중일 때 뒷배경을 어둡게 누르는 오버레이 */
.dim-overlay {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0);
  pointer-events: none;
  transition: background 3s ease, backdrop-filter 1s ease;
  z-index: 290; /* 모달 바로 아래 */
}

.dim-overlay.active {
  background: rgba(5, 7, 13, 0.8); /* 80% 어둡게 */
  backdrop-filter: blur(3px); /* 뒤에 있는 별들을 살짝 흐리게 */
}